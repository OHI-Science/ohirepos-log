# This is prep_mhi.Rmd

## 0. add col to `sc_studies_custom.csv` 

Add by hand to `ohirepos-log/repo_registry.csv`

## 1. setup
```{r setup, eval=F}

# run create_repos.rmd setup chunk

```

## 2. maps
```{r setup, eval=F}

# read in shp files and save with desired headers in data frame.
shp = rgdal::readOGR(dsn = repo_registry$dir_shp_in, layer = WH_OHI_zones_TW12NM)

# view dataframe and map
shp@data
plot(shp)

## clean up
shp@data <- shp@data %>%
  dplyr::mutate(area_km2 = Shape_Area / 1000) %>%
  dplyr::select(rgn_id = Id, rgn_name = Zone, area_km2 )
shp@data$rgn_id[shp@data$rgn_name == "South"] = 1
shp@data$rgn_id[shp@data$rgn_name == "North"] = 2

## save as shapefiles. will create 4 files: .dbf, .prj, .shp, .shx
rgdal::writeOGR(shp, dsn = repo_registry$dir_shp_in, layer = key, driver = 'ESRI Shapefile', overwrite=TRUE)

## ave/rgn_offshore_data.csv on git-annex
write.csv(shp@data, file.path(repo_registry$dir_shp_out, 'rgn_offshore_data.csv'))

# # create lookup table with unique rgn_ids
# dir.create( sprintf('%s/%s', repo_registry$dir_repo,repo_registry$scenario_name))
# dir.create( sprintf('%s/%s/spatial', repo_registry$dir_repo,repo_registry$scenario_name))
# write_csv(shp@data, sprintf('%s/%s/spatial/%s_rgns_custom.csv', repo_registry$dir_repo,repo_registry$scenario_name, key))

```
